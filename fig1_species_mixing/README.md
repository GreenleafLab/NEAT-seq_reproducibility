# Figure 1 Species Mixing
Code to reproduce the results from the species mixing experiment in Figures 1d-f and S1d-f.

## Data files
- `ADT_table.csv.gz`: Unfiltered ADT counts table
- `combined_blacklist.bed`: Combined blacklist regions from hg38 and mm10, as generated by the `custom_hg38_mm10_reference/Snakefile` pipeline.
- `genes.gtf.gz`: Gene annotations for the hg38+mm10 genome, as generated by the `custom_hg38_mm10_reference/Snakefile` pipeline.

## Code files
- `custom_hg38_mm10_reference`: Folder with example code to recreate the combined hg38 + mm10 genome reference for `cellranger-arc`. Will not run without additional modifications. 
- `barnyard_analysis.R`: Plotting and regeneration of processed GEO files from raw data
    - Inputs: RNA feature matrix & ATAC fragments from GEO
    - Outputs: 
        - `adt_counts.csv.gz` - Filtered ADT counts as uploaded to GEO
        - `cell_calls.tsv` - Cell calls table
        - `plots.pdf` - Plots from Figures 1d-f and S2a-f
- `species_mixing_utils.R`: utility functions used by `barnyard_analysis.R`